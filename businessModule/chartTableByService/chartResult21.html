<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="pragma" content="no-cache">
    <link rel="stylesheet"  href="../resource/js/ligerUI/skins/Aqua/css/ligerui-all.css">
    <link rel="stylesheet"  href="c../chartTable/hartTable.css?v=1.0.0">
    <title>查询统计结果</title>
</head>
<body>
    <div class="container container21">
        <div class="topLeft">
            <div class="l-clear"></div>
            <div id="maingrid" class="grid"></div>
        </div>
        <div class="topRight" id="pieChart"></div>
        <div class="clear"></div>
        <div class="bottom" id="columnChart"></div>
    </div>
    <script src="../resource/js/jquery-3.1.0.min.js"></script>
    <script src="../resource/js/ligerUI/js/core/base.js"></script>
    <script src="../resource/js/ligerUI/js/plugins/ligerGrid.js"></script>
    <script src="../resource/js/ligerUI/js/plugins/ligerResizable.js"></script>
    <script src="../resource/js/jquery.canvasjs.min.js"></script>
    <script type="text/javascript">
        window.onload = function () {
            var key = getQueryString("key"),
                    serviceUrl = parent.mapLayerConfig.getServiceUrlByName(getQueryString("serviceKey"));
            parent.geoneAjax.handleAjax({
                url: serviceUrl, data: {key: key}, callback: function (result) {
                    showResult(result);
                }
            });
        };

        function  showResult(result) {
            var  data = result.data.grid.data;
            var grid = $("#maingrid").ligerGrid({
                columns: result.data.grid.columns,
                data: {
                    Rows: data,
                    Total: data.length
                },
                headerRowHeight: 35,
                allowAdjustColWidth: true,
                usePager: false,
                width: '99%',
                height: '275px'
            });

            var array = ["pieChart", "columnChart"];
            $(result.data.chart).each(function (index, chart) {
                var chartPie = new CanvasJS.Chart(array[index], chart);
                chartPie.render();
            });
        }
    </script>
</body>
</html>